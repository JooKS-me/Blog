---
title: "myblog玩具总结"
date: Thu Feb 04 22:24:18 CST 2021
categories: ["项目"]
tags: ["项目"]
draft: false
---

> ~~myblog项目就是您现在看到的这个网站，本项目已开源至GitHub~~
>
> ~~仓库地址：https://github.com/JooKS-me/myblog~~
> 
> 出于安全考虑，现在已闭源

最初设想的时候是这样的：[个人博客项目初步分析 - JooKS的小站](https://www.jooks.cn:81/index.php/archives/105/)。

根据当时的设想，现在应该是还没做完的，还剩下用户注册、评论、关于我、友链这四个模块。但是有了现在的基础框架，增加这些功能应该不难。

还有技术栈方面，距离最初设计有所偏差。下面细细说来~

### 先说说后端吧

后端主要就是在安全框架上发生了变化，~~由于看不懂SpringSecurity配置JWT~~，我使用了Shiro来代替，Shiro虽然配置麻烦点，但我更能理解它的运行流程。最终也实现了单点登录。至于为什么要做单点登录呢。。。因为想用JWT。。。

后面的话，我会引入Redis，对Shiro的Session进行缓存，实现服务器端的注销功能。

然后还有sql方面，中间在做的时候接触到了mybatis plus，但是最终我去掉了，还是选择了mybatis。因为mp用着感觉跟spring data jpa还有jdbc template差不多。而且它还帮我生成了service和controller，这使得我不知道该让事务在哪里开起来。至于mp的分页查询功能，完全可以用mybatis pagehelper代替。所以最终我使用了mybatis还有pagehelper，也挺好用的。

然后最终部署的时候，因为服务器上其他软件的某些需求，需要前端页面强制开启https。然后前端https后端http的话，异步请求的时候会直接报错，于是加了ssl加密，让后端也强制https。

### 再来说说前端

前端几乎是边学边做的，所以写的很累，最终代码结构也有点乱。前端用到了Vue-Cli脚手架，这个东西好强@^@

为了开发方便，用了ElementUI，覆盖了一些它的css样式。eu原本的风格是偏蓝的，我覆盖了之后，前台界面是偏灰的，后台就比较原生了~~(毕竟只能给自己看，就懒得改了)~~。

登录、权限验证（前后端都有做拦截）这个模块用到了Vuex，将登录后返回的token保存到localStore中。每次发起请求时都在header中加上这个token（这个地方是通过给Axios的写了拦截器实现的）。注销的时候，就把localStore中的token销毁。但是要是前端不销毁，后端也没办法，这就是用token的一个缺点了，之后打算引入redis解决。

靠。。。感觉精力都花在权限验证上了。。。

**最后，项目部署后我发现移动端访问出大问题，跟X一样。** 于是，参考[vue项目移动端、pc端适配方案](https://blog.csdn.net/weixin_45031595/article/details/104194510)这篇博客，引入了Flexible，将px自动转换为rem。效果是很明显，但最终还是有些细节不太合适，为时已晚QAQ。下次应该在项目开始就引入，边做边调整。下次一定，下次一定。。。

### 最后说说部署

部署因为在Linux上，得让某些特殊功能不受影响，还是踩了好多坑的。

首先是**后端的部署**，坑就在https上。前面说了，后端API一定得通过HTTPS访问。那么怎么实现呢？

一种是直接在springboot配置文件中加上证书的信息就好了。是不是看起来很简单，但是这有个弊端，我的那个特殊功能可以自动申请证书，两个月一次，也就是说，每过两个月，我就得改一次配置文件，重新打包，这也太mmp了吧！

还有一种方案是我在依赖里排除掉内嵌的tomcat，打成war包，然后丢给服务器上的tomcat，只需要修改tomcat的配置即可，就不用每次都打包了。虽然简单了一些，但用tomcat好像没内味。

于是我申请了一年的证书。。。最终用第一种方案，只需要每年重新打一次包。

然后前端部署上没什么大问题了，主要在Nginx的配置文件。

这边之后打算学学docker编排，用docker部署似乎方便很多很多



---

最后附上项目示意图。

![y3sNXd.md.png](https://s3.ax1x.com/2021/02/04/y3sNXd.md.png)

后台的一些截图

![y3g4r4.md.png](https://s3.ax1x.com/2021/02/04/y3g4r4.md.png)
